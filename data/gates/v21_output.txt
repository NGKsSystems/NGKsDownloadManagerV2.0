Download Manager V2.1 Acceptance Test
==================================================
Test directory: C:\Users\suppo\AppData\Local\Temp\v21_acceptance_s8nnbztr
Server started at: http://localhost:52543
Serve directory: C:\Users\suppo\AppData\Local\Temp\range_server_rw4pcsri
Range endpoint: http://localhost:52543/range/
No-range endpoint: http://localhost:52543/norange/
Creating 12MB test file...
Source file hash: c2762aa871303028d6915f39bd927470cd12c59dc78e277edfd6615f66cbb680
Creating 48MB resume test file...
Resume test file hash: fce0f3b4b34b8781c4f4bbdd0f3f123714fc7d9f7f04a1b2ad3b3b8c0d4c7e8b

=== Test 1: Multi-Connection Mode ===
Base URL: http://localhost:52543
Serve directory: C:\Users\suppo\AppData\Local\Temp\range_server_rw4pcsri
Exact URL: http://localhost:52543/range/testfile.dat
Downloading http://localhost:52543/range/testfile.dat
Expected: multi-connection mode, 4 connections
PASS: Multi-mode verified (mode=multi, connections=4, time=8.82s)

=== Test 2: Single-Connection Fallback ===
Base URL: http://localhost:52543
Serve directory: C:\Users\suppo\AppData\Local\Temp\range_server_rw4pcsri
Exact URL: http://localhost:52543/norange/testfile.dat
Downloading http://localhost:52543/norange/testfile.dat
Expected: single-connection fallback
PASS: Single fallback verified (mode=single, connections=1)

=== Test 3: Interruption and Resume ===
Testing with 48MB file for reliable interruption
Base URL: http://localhost:52543
Serve directory: C:\Users\suppo\AppData\Local\Temp\range_server_rw4pcsri
Exact URL: http://localhost:52543/range/resume_testfile.dat
Testing interruption and resume for http://localhost:52543/range/resume_testfile.dat
(Using 48MB file with slow mode for reliable interruption)
Phase 1: Starting download and interrupting...
Waiting for substantial part files to appear...
Found 5.1MB partial data
Substantial progress found, triggering cancellation...
Download was properly interrupted
State file created successfully
State file structure verified
Phase 2: Resuming download...
PASS: Interrupt+resume verified (48MB file, hash match)

==================================================
FINAL RESULTS
==================================================
PASS: Multi-Connection Mode - mode=multi, connections=4
PASS: Single-Connection Fallback - mode=single, connections=1
PASS: Interruption & Resume - interrupt+resume verified with 48MB file

Tests passed: 3/3
OVERALL: PASS

Teardown:
Server stopped
Test directory cleaned


